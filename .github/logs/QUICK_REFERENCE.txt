â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          StatusWatch EC2 Authentication - Quick Reference            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ ISSUE: Login fails on EC2 with "No active account found"
   Works locally but not on remote EC2 instance

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ QUICK START (Run on EC2)

1. Pull latest code:
   $ cd ~/statuswatch-project
   $ git pull origin main

2. Restart backend (to apply logging changes):
   $ docker restart backend

3. Run all diagnostics:
   $ chmod +x .github/logs/run_all_diagnostics.sh
   $ ./.github/logs/run_all_diagnostics.sh

4. Download results to your local machine:
   $ scp ubuntu@<EC2-IP>:~/statuswatch-project/.github/logs/diagnostics_*.tar.gz .

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ INDIVIDUAL DIAGNOSTIC COMMANDS

Full System Check:
  $ ./.github/logs/ec2_auth_diagnostics.sh > diagnostics.txt 2>&1

Quick Auth Test:
  $ ./.github/logs/test_auth.sh

Watch Debug Logs (Real-time):
  $ docker exec backend tail -f /app/logs/auth_debug.log | python3 -m json.tool

Read Debug Logs:
  $ ./.github/logs/read_auth_debug_logs.sh 50

Manual User Check:
  $ docker exec backend python manage.py shell -c "
    from django_tenants.utils import schema_context
    from django.contrib.auth import get_user_model
    User = get_user_model()
    with schema_context('acme'):
        user = User.objects.get(email='jwt@example.com')
        print(f'Active: {user.is_active}')
        print(f'Password OK: {user.check_password(\"TestPass123!\")}')"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” KEY FILES TO CHECK

After running diagnostics, review these files:

1. full_diagnostics.txt
   â†’ Section 4: User existence & password verification
   â†’ Section 6: Django settings (DEBUG, ALLOWED_HOSTS)
   â†’ Section 7: Environment variables

2. auth_debug_logs.txt
   â†’ "password_check_result": true/false
   â†’ "schema_name": should be "acme"
   â†’ "user_exists": should be true

3. backend_logs.txt
   â†’ Look for authentication errors
   â†’ Check for middleware issues

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš¡ COMMON FIXES

If user doesn't exist:
  $ docker exec -it backend python manage.py shell
  >>> from scripts.create_acme_user import create_acme_user
  >>> create_acme_user()

If password hash is wrong:
  $ docker exec -it backend python manage.py shell -c "
    from django_tenants.utils import schema_context
    from django.contrib.auth import get_user_model
    User = get_user_model()
    with schema_context('acme'):
        user = User.objects.get(email='jwt@example.com')
        user.set_password('TestPass123!')
        user.save()
        print('Password reset!')"

If schema routing is wrong:
  Check domain configuration in database

If DEBUG=True in production:
  Set DJANGO_ENV=production in .env and restart

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ› REAL-TIME DEBUGGING

Terminal 1 - Watch auth debug logs:
  $ docker exec backend tail -f /app/logs/auth_debug.log | python3 -m json.tool

Terminal 2 - Watch Django logs:
  $ docker logs -f backend

Terminal 3 - Watch Nginx logs:
  $ docker logs -f nginx

Then attempt login via browser and watch all three terminals

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ WHAT TO SHARE

After running diagnostics:
  1. The generated .tar.gz file from .github/logs/
  2. Or individual files from diagnostics_TIMESTAMP/ directory

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’¡ TIPS

â€¢ Enhanced logging writes to: /app/logs/auth_debug.log (in container)
â€¢ Logs persist across container restarts
â€¢ Sensitive data is automatically sanitized
â€¢ Debug logging can be disabled after fixing

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

For detailed instructions, see:
  .github/logs/README_DIAGNOSTICS.md

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
